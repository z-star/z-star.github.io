<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>z-star</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="z-star的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="z-star">
<meta property="og:url" content="http://www.fovoy.com/page/2/index.html">
<meta property="og:site_name" content="z-star">
<meta property="og:description" content="z-star的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="z-star">
<meta name="twitter:description" content="z-star的博客">
  
  
   <link rel="shortcut icon" type="image/x-icon"  rel="icon" href="/css/images/favicon.ico">
  
  
 <link href='//fonts.useso.com/css?family=Open+Sans:400italic,400,600' rel='stylesheet' type='text/css'>
 <link href="//fonts.useso.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">


  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css" type="text/css">
  

  

  
</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-main" class="header-inner">
    <div class="outer">
      <a href="/" id="logo"><i class="logo" style="background-image: url(/css/images/logo.png)"></i><span class="site-title">z-star</span></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/.">首页</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/categories">Categories</a>
        
          <a class="main-nav-link" href="/tags">Tags</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
      
        <nav id="sub-nav">
          <div class="profile" id="profile-nav">
            <a id="profile-anchor" href="javascript:;"><img class="avatar" src="/css/images/avatar.png"><i class="fa fa-caret-down"></i></a>
          </div>
        </nav>
      
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit"> </button><input type="hidden" name="sitesearch" value="http://www.fovoy.com"></form>
      </div>
    </div>
  </div>
  <div id="main-nav-mobile" class="header-sub header-inner">
    <table class="menu outer">
      <tr>
        
          <td><a class="main-nav-link" href="/.">首页</a></td>
        
          <td><a class="main-nav-link" href="/archives">Archives</a></td>
        
          <td><a class="main-nav-link" href="/categories">Categories</a></td>
        
          <td><a class="main-nav-link" href="/tags">Tags</a></td>
        
          <td><a class="main-nav-link" href="/about">About</a></td>
        
        <td>
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><input type="hidden" name="sitesearch" value="http://www.fovoy.com"></form>
        </td>
      </tr>
    </table>
  </div>
</header>

    <div class="outer">
      
        <aside id="profile">
  <div class="inner profile-inner">
    <div class="base-info profile-block">
      <img id="avatar" src="/css/images/avatar.png">
      <h2 id="name">z-star</h2>
      <h3 id="title"> Developer</h3>
      <span id="location"><i class="fa fa-map-marker"></i>beijing, China</span>
      <a id="follow" href="https://github.com/z-star/">关注我</a>
    </div>
    <div class="article-info profile-block">
      <div class="article-info-block">
        119
        <span>文章</span>
      </div>
      <div class="article-info-block">
        73
        <span>标签</span>
      </div>
    </div>
    
    <div class="contact-info profile-block">
      <table class="contact-list">
        <tr>
          
          <td><a href="http://github.com/z-star" target="_blank" title="github"><i class="fa fa-github"></i></a></td>
          
          <td><a href="/#" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></td>
          
          <td><a href="/#" target="_blank" title="facebook"><i class="fa fa-facebook"></i></a></td>
          
          <td><a href="/#" target="_blank" title="dribbble"><i class="fa fa-dribbble"></i></a></td>
          
          <td><a href="/" target="_blank" title="rss"><i class="fa fa-rss"></i></a></td>
          
        </tr>
      </table>
    </div>
    
    
  </div>
</aside>

      
      <section id="main">
      <article id="post-idea-license" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/12/idea-license/">idea-license</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/07/12/idea-license/">
      <time datetime="2016-07-12T01:25:12.000Z" itemprop="datePublished">2016-07-12</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/tools/">tools</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p><a href="http://www.iteblog.com/idea/key.php" target="_blank" rel="external">http://www.iteblog.com/idea/key.php</a></p>
<p>使用idea remote debug</p>
<p>1.确认tomcat的dev环境中的startenv.sh中，是否有xdebug的参数设置：</p>
<p>-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=8145</p>
<p>2.socat TCP4-LISTEN:8888,fork,range=10.86.48.24/23 TCP4:127.0.0.1:8145</p>
<ul>
<li><p>8888改为任意没有被使用的端口，比如9998</p>
<p>*range的IP确认和自己本地ip是否在一个域里。</p>
</li>
</ul>
<p>3.idea里新建 run configuration 里的remote。</p>
<p>  Settings-&gt; Host 改为服务器域名 例：l-kola3.f.dev.cn0.qunar.com</p>
<pre><code>端口号改为上面的 <span class="number">9998</span>
</code></pre><p>4.点debug运行</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/07/12/idea-license/" data-id="cixo3b4wf009lzes6n2wirlck" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/idea/">idea</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-面试总结" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/06/面试总结/">总结</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/07/06/面试总结/">
      <time datetime="2016-07-06T01:25:12.000Z" itemprop="datePublished">2016-07-06</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/总结/">总结</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p> 每两周只专注做一个分支的学习。</p>
<hr>
<p>1.mq rocketmq q 对比总结<br>2.中间件实践</p>
<h2 id="3-java_web分析">3.java web分析</h2><p>1.order-store ,因为main-verison 和detail-version的设计，所以是的，version冲突很少，除非是连续同一个section的连续操作，才有可能出现冲突。<br>为题:memcache配置 9个节点，(lzf压缩)cas 可能存入过期数据，所以需要检查version。大小基本相同的数据，碎片问题不会产生。主从备份。单挑记录大小。80k 压缩成10k, slab-&gt;page(1M)-&gt;chunk(变长96字节),根据插入数据大小选择合适的chunk。所以可能产生内存浪费，100btye,放到128btye. PXC MHA<br>2.order-core</p>
<p>3.actor<br>actor自定义标签，继承NameSpaceHandlerSupport解析标签。顶一个一parser 继承AbstractSingleBeanDefinitionParser。来解析用户xml文件。两个主要的类，Engine，Scanner。EngineContext<br>BeanPostProcessor来扫描，标签添加actor事件。ActorWrapperAdaptor解析出Event和Parser. 所有的都失败，才会让qmq从发，或者一个失败，就持久化一个，让他重试。</p>
<p>4.监控<br>收集指数的时候，保证时间间隔必须大于55秒，并且当前秒数必须小于5。历史数据其实是一直在增加的。快照的思想，把每一分钟的数据都记录下来，[(seq.incrementAndGet() - 1) &amp; maxSeq] [(seq.get() - count) &amp; maxSeq] 在服务器取数据的时候，就是当前减去上一分钟。</p>
<h2 id="url从应用中心中拿，定时任务收集，指数。收集到之后吧数据存储在watcher里面。再由watcher_graphit_吐数据。">url从应用中心中拿，定时任务收集，指数。收集到之后吧数据存储在watcher里面。再由watcher graphit 吐数据。</h2><p>spring mybatis netty zk</p>
<hr>
<h2 id="上下文切换又分为2种：让步式上下文切换和抢占式上下文切换。前者是指执行线程主动释放CPU，与锁竞争严重程度成正比，可通过减少锁竞争来避免；后者是指线程因分配的时间片用尽而被迫放弃CPU或者被其他优先级更高的线程所抢占，一般由于线程数大于CPU可用核心数引起，可通过调整线程数，适当减少线程数来避免。">上下文切换又分为2种：让步式上下文切换和抢占式上下文切换。前者是指执行线程主动释放CPU，与锁竞争严重程度成正比，可通过减少锁竞争来避免；后者是指线程因分配的时间片用尽而被迫放弃CPU或者被其他优先级更高的线程所抢占，一般由于线程数大于CPU可用核心数引起，可通过调整线程数，适当减少线程数来避免。</h2><p>如何在有限的资源里处理一个较大的数据:如果你处理逻辑，跟全量数据有关，例如对全部数据进行排序，这个可以采用bitmap,堆排序等之类的，网上可以搜到。</p>
<h2 id="但是如果你的处理逻辑跟全量数据无关，那就跟简单了，你可以设置一个buffer，每次读满一个buffer，处理完了，再读下一个buffer。">但是如果你的处理逻辑跟全量数据无关，那就跟简单了，你可以设置一个buffer，每次读满一个buffer，处理完了，再读下一个buffer。</h2><p>高并发，低耗时的情况：建议少线程，只要满足并发即可；例如并发100，线程池可能设置为10就可以. 线程少就能处理，因为耗时低，所以几个线程就够。<br>低并发，高耗时的情况：建议多线程，保证有空闲线程，接受新的任务；例如并发10，线程池可能就要设置为20，耗时高需要多线程。所以线程多少取决于耗时。</p>
<h2 id="高并发，高耗时的情况：耗时低线程少，耗时高线程多，异步+回调。shard-">高并发，高耗时的情况：耗时低线程少，耗时高线程多，异步+回调。shard.</h2><p>1 浏览器地址栏打开的默认就是GET，所以链接用GET很方便。<br>2 POST的提交需要表单或js提交，麻烦。<br>3 GET可以使用缓存</p>
<h2 id="4_GET有利于SEO">4 GET有利于SEO</h2><p>OOM<br>OMM主要三类： permgen OOM , heap OOM, stack overflow<br>permgen OOM: 这个主要是由于加载的类太多，或者反射的类太多， 还有 调用 String.intend（jdk7之前）也会造成这个问题。所以出现了这个问题，就检查这三个方面；<br>heap OOM： 基本是按照 1楼的方式就可以解决了，主要是因为一些无用对象没有及时释放造成的，检查代码加上 heap dump 去分析吧</p>
<h2 id="stack_overflow：_这个主要是由于调用层数，或者递归深度太大造成的，看异常信息，基本上就能定位得出来了。">stack overflow： 这个主要是由于调用层数，或者递归深度太大造成的，看异常信息，基本上就能定位得出来了。</h2><p>LRU –LinkedHashMap   accessOrder设为true，按照访问顺序排序.</p>
<hr>
<p>   ==比较的是2个对象的地址，而equals比较的是2个对象的内容。<br>    显然，当equals为true时，==不一定为true；</p>
<ol>
<li>对事务，并发，JVM，幂等，并发控制的理解.隔离级别的理解。远程debug使用。<br>Spring 所有的事务管理继承 PlatformTransactionManager<br>当事务方法被另一个事务方法调用时，必须指定事务应该如何传播<br>TransactionDefinition.PROPAGATION_REQUIRED：如果当前存在事务，则加入该事务；如果当前没有事务，则创建一个新的事务。这是默认值。<br>TransactionDefinition.PROPAGATION_REQUIRES_NEW：创建一个新的事务，如果当前存在事务，则把当前事务挂起。<br>TransactionDefinition.PROPAGATION_SUPPORTS：如果当前存在事务，则加入该事务；如果当前没有事务，则以非事务的方式继续运行。<br>TransactionDefinition.PROPAGATION_NOT_SUPPORTED：以非事务方式运行，如果当前存在事务，则把当前事务挂起。<br>TransactionDefinition.PROPAGATION_NEVER：以非事务方式运行，如果当前存在事务，则抛出异常。<br>TransactionDefinition.PROPAGATION_MANDATORY：如果当前存在事务，则加入该事务；如果当前没有事务，则抛出异常。<br>TransactionDefinition.PROPAGATION_NESTED：如果当前存在事务，则创建一个事务作为当前事务的嵌套事务来运行；如果当前没有事务，则该取值等价于TransactionDefinition.PROPAGATION_REQUIRED。<br>隔离级别<br>未提交读（Read uncommitted）<br>已提交读（Read committed）<br>可重复读（Repeatable read）<br>可串行化（SERIALIZABLE）<br>回滚：默认配置下，spring只有在抛出的异常为运行时unchecked异常时才回滚该事务，也就是抛出的异常为RuntimeException的子类(Errors也会导致事务回滚)，而抛出checked异常则不会导致事务回滚。非检查异常够了。。<br>脏读:未提交就被读到。不可重复读:不会读到更新数据。幻读：不会读到插入，删除数据。<br>数据库事务：<br>数据库事务:redo log(事务日志，原子性和持久性，因为事务日志块的大小和磁盘扇区的大小一样,都是512字节,所以不用双写保证)undo log(用来保证事务的一致性)<br>redo log 记录事务修改后的数据, undo log 记录事务前的原始数据。<br>JDBC事务：简单，多个sql 一起提交。但无法实现分布式事务，无法夸数据库。<br>JTA事务：实现了XA规范的相关接口的类才能参与到JTA事务中来，需要一个协调者,来协调单个节点的信息。X/Open DTP XA由数据库提供商完成的函数接口(AP,TM,RM,CRM),<br>二阶段提交(准备和提交),三阶段提交(能否提交，准备提交，提交)是XA延伸而来.区别，为减少单点故障，减少阻塞，强一致性只有Paxos算法。<br>无阻队列ConcurrentLinkedQueue 使用CAS来操作，队列中，从头读从尾进。入队定位。</li>
<li>对技术框架等Sping,nginx不仅会使用，要理解原理，自己的思考。<br>spring ioc aop BeanPostProcessor </li>
<li>项目介绍（时间，并发量，什么业务）</li>
<li>http几个版本  1.0 1.1 2.0</li>
<li>jdbc怎么开发事务 connection 中使用关系自动提交，多个excute 之后commit;</li>
<li>哈希map 怎么实现 数组和链表 红黑树。</li>
<li>对分布式环境下如何实现事务的最终一致性的想法  需要一个确认回调。</li>
<li>jvm的内存模型的理解，threadlocal使用场景及注意事项<br>复制算法，标记清除，标记整理 </li>
<li>synchronized和类加载的理解  synchronized 普通方法 锁的是实例，静态方法锁的是Class,同步方法块锁的是括号里的对象。<br>增加了锁的状态来让执行效率更高：无锁-&gt;偏向锁(没有竞争)-&gt;轻量级锁(CAS竞争)-&gt;重量级锁。<br>java 头里存储着synchronized信息，偏向锁，同一个线程重复获取锁，不用重复CAS直接获取，<br>classLoad bootstrap extention app urlclassload</li>
<li>架构问题：双十一怎么解决高并发问题，架构方案；稳定性20百分，怎么提高到那么高的；数据库分库分表怎么实现的；二分协议算法和zookeepper算法有什么联系。为什么要用这个做架构。怎么保证消息最新。自己的架构好在哪里，架构师哪些最成功的，有什么经验，对哪些最认可.</li>
<li>double/zookeeper 的使用情况，WMS项目架构说明？—架构方面</li>
</ol>
<ol>
<li>spring事物 java 的设计模式。spring的aop如何实现？<br>Spring并不直接管理事务，而是提供了多种事务管理器.通过DataSource来获取connection. 在Spring 中为TransactionDefinition。<br>大多数的数据库默认隔离级别为 Read Commited，(提交之后就可以读) 比如 SqlServer、Oracle 。少数数据库默认隔离级别为：Repeatable Read 比如： MySQL InnoDB<br>在一个事务中前后两次读取的结果并不致，导致了不可重复读。同样的条件, 第1次和第2次读出来的记录数不一样,幻读。不可重复读的重点是修改 :<br>同样的条件, 你读取过的数据,再次读取出来发现值不一样了 幻读的重点在于新增或者删除 同样的条件, 第 1 次和第 2 次读出来的记录数不一样。<br>Aop 就是动态代理实现了，在目标方法前后的具体操作。</li>
<li>map同步，jpk关键字的原理，Threablocal原理是怎么实现的<br>每一个线程都有一个 TreadLocalMap 来保持线程变量。一定要注意finally，清除状态信息。</li>
<li>大数据量搜索的问题。给出解决问题的思路<br>倒排索引</li>
<li>缓存框架—Ehcache（Ehcache和readies都是用来缓存的，他们分别在什么时候使</li>
<li>分布式。数据库  web集群是怎么配的，数据库的读写分离（用来优化搜索的）<br>分布式</li>
<li>分库分表后，如果某一个表还是超大，怎样提高效率(加索引)<br>加索引。</li>
<li>数据库的死锁和活锁<br>*<br>19 怎样处理30万用户每天的访问量？比如休一休，抢红包，上亿数据量，如何对你的系统进行性能优化</li>
<li>synchronized和class加载</li>
<li>系统设计不足要主动推进</li>
<li>数据库事务<br>23.ReferenceQueue 弱引用和虚引用被回收时候回被加入到引用队列里面去<br>24.JAVA内存模型<br>虚拟机中将变量存储到内存，从内存中取出来这个底层细节。<br>JAVA内存模型规定，变量都存在主存中(内存)，每条线程有自己的工作线程。(寄存器或者高速缓存中)<br>25.Jvm内存区域<br>heap stack Permgen 计数器<br>随着Java8的到来，我们再也见不到永久代了。但是这并不意味着类的元数据信息也消失了。这些数据被移到了一个与堆不相连的本地内存区域,元空间。<br>26.远程debug<br>1.Java读取文件<br>2.Sql统计重复数据<br>3.表单重复提交<br>4.jvm内存模型实际应用中的理解<br>5.工作中对本部门业务的认识<br>6.工作中对相关依赖部门业务认识<br>7.RPC服务理解<br>8.Spring相关知识 IOC理解+AOP<br>9.平时对事务的使用和理解<br>10.JVM内存模型<br>11.浏览器输入域名后处理过程<br>12.SSL<br>13.RPC服务理解<br>14.如何自己实现一个RPC服务，要点有那些<br>15.本公司业务的认识<br>16.遇到挫折的事情，如何解决<br>17.工作上遇到一些事情如何处理<br>18.与同事沟通</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/07/06/面试总结/" data-id="cixo3b4r30003zes6g5eimt6e" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/专注/">专注</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-ConcurrentModificationException异常解析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/12/ConcurrentModificationException异常解析/">ConcurrentModificationException异常解析</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/05/12/ConcurrentModificationException异常解析/">
      <time datetime="2016-05-12T05:22:01.000Z" itemprop="datePublished">2016-05-12</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <h2 id="当你对一个集合，一边遍历，一边修改时候。因为遍历过程中游标不知道集合的修改遍历出来的数据会有问题。所以要提早检查错误，提前失败。其意义在于极端情况下如果集合数据很多，如果不快速失败，消耗了时间又没有好结果。">   当你对一个集合，一边遍历，一边修改时候。因为遍历过程中游标不知道集合的修改遍历出来的数据会有问题。所以要提早检查错误，提前失败。其意义在于极端情况下如果集合数据很多，如果不快速失败，消耗了时间又没有好结果。</h2><p>   fail-fast机制<br>    “快速失败”也就是fail-fast，它是Java集合的一种错误检测机制。当多个线程对集合进行结构上的改变的操作时，有可能会产生fail-fast机制。记住是有可能，而不是一定。例如：假设存在两个线程（线程1、线程2），线程1通过Iterator在遍历集合A中的元素，在某个时候线程2修改了集合A的结构（是结构上面的修改，而不是简单的修改集合元素的内容），那么这个时候程序就会抛出 ConcurrentModificationException 异常，从而产生fail-fast机制。</p>
<p>  多线程情况下 一个遍历，一个修改，会出错。因此一般有2种解决办法：</p>
<p>　　1）在使用iterator迭代的时候使用synchronized或者Lock进行同步，但这样的方式会让遍历操作堵塞。</p>
<p>　　2）使用并发容器CopyOnWriteArrayList代替ArrayList和Vector。<br>   CopyOnWriterArrayList 源码 add重要的三行<br>    <figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Object[] newElements = Arrays.copyOf(elements, len + 1)<span class="comment">;</span></span><br><span class="line">    newElements[len] = e<span class="comment">;</span></span><br><span class="line">    setArray(newElements)<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>本质就是复制原来的array,在新数组进行修改操作，所以不影响原来数组的遍历。但这样会生产很多对象，相当有损耗的。</p>
<p>[TOC]</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/05/12/ConcurrentModificationException异常解析/" data-id="cixo3b4yw00e4zes6yd6hnnfw" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ConcurrentModificationException/">ConcurrentModificationException</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-并发编程" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/12/并发编程/">并发编程</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/05/12/并发编程/">
      <time datetime="2016-05-12T05:22:01.000Z" itemprop="datePublished">2016-05-12</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>并发编程可能遇到的问题：原子性，可见性，有序性。</p>
<ol>
<li><p>原子性：即一个操作或者多个操作 要么全部执行并且执行的过程不会被任何因素打断，要么就都不执行。假如要为一个32位的变量赋值包括两个过程：为低16位赋值，为高16位赋值。必须保持原子性，要不最后结果肯定是错的。</p>
</li>
<li><p>可见性：是指当多个线程访问同一个变量时，一个线程修改了这个变量的值，其他线程能够立即看得到修改的值。</p>
</li>
<li><p>有序性：即程序执行的顺序按照代码的先后顺序执行。但在多线程环境中，有序性是无效的。</p>
</li>
</ol>
<hr>
<p>上下文切换又分为2种：让步式上下文切换和抢占式上下文切换。<br>  前者是指执行线程主动释放CPU，与锁竞争严重程度成正比，可通过减少锁竞争来避免，也叫无锁并发编程，hash分段。避免资源竞争。<br>  后者是指线程因分配的时间片用尽而被迫放弃CPU或者被其他优先级更高的线程所抢占，一般由于线程数大于CPU可用核心数引起，可通过调整线程数，适当减少线程数来避免。<br>  CAS算法避免加锁，或者使用协程，在单个线程里实现多任务的调度，并在单线程里维持多个任务时间的切换。<br>查看线程状态jstatck pid &gt; dump  |awk ‘match($0,”‘java.lang.Thread.State’”){print $2$3$4$5}’|sort |uniq -c  查看waiting数量<br>三、线程中状态：<br>a:runnable状态，运行状态<br>b:TIMED_WAITING(on object monitor)当前线程被挂起一段时间,说明该线程正在执行obj.wait(int time) Thread.join(long),sleep(long)方法. 线程太多 会打大量这个状态。<br>c.BLOCKED 当前线程被堵塞，等待别的线程占用的资源。<br>d.TIMED_WAITING(sleeping) 当前线程被挂起一段时间,即正在执行Thread.sleep(inttime)方法.<br>e.TIMED_WAITING(parking) 当前线程被挂起一段时间,即正在执行LockSupport.parkNamos()方法. </p>
<h2 id="f-WAINTING(on_object_monitor)_当前线程被挂起，即正在执行obj-wait()方法(无参数的wait()方法)-必须等待别唤醒。">f.WAINTING(on object monitor) 当前线程被挂起，即正在执行obj.wait()方法(无参数的wait()方法).必须等待别唤醒。</h2><p>socket 中的time_wait 是大量打开，关系socketfd造成的，而close_wait 是没有响应关闭造成的。</p>
<hr>
<p>在单例模式中,双重检查必须要加volatile,要不然在synchronized里面的初始化，会因为instance 复制，但没有初始化成功而出现错误，这是是因为内存重排序造成的。<br>所以volatile禁止了，初始化和指向赋值的重拍。<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">private<span class="keyword"> static</span> volatile Instance instance;<span class="keyword"></span><br><span class="line">public</span><span class="keyword"> static</span> Instance<span class="function"> getInstance(</span><span class="function">)</span>&#123;</span><br><span class="line">	if(instance ==null<span class="function">)</span>&#123;</span><br><span class="line">     <span class="function"> synchronized(</span>xxx.class<span class="function">)</span>&#123;</span><br><span class="line">     <span class="function"> if(</span>instance==null<span class="function">)</span>&#123;</span><br><span class="line">      <span class="instruction"> instance </span>=<span class="instruction"> new </span>Instance(<span class="function">)</span>; //初始化</span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="instruction"> return </span>instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="死锁：当一个线程同时获取多把锁的情况下就可能出现死锁。避免占用多个资源，使用lock-tryLock(TIME_OUT)线程状态BLOCKED,死锁就是相互等待。">死锁：当一个线程同时获取多把锁的情况下就可能出现死锁。避免占用多个资源，使用lock.tryLock(TIME_OUT)线程状态BLOCKED,死锁就是相互等待。</h2><h2 id="资源限制：在资源有限的情况下，多开线程，并不能加快速度。并发编程最后跟串行执行，那加上下文切换的消耗，还会慢了。">资源限制：在资源有限的情况下，多开线程，并不能加快速度。并发编程最后跟串行执行，那加上下文切换的消耗，还会慢了。</h2><p>volatile:可见性，主要由cup缓冲回写内存，并导致其他处理器缓存失效。来完成可见性。</p>
<h2 id="追加到64字节提高并发效率，L1缓存行是64字节。避免头尾节点不在同一个缓存行，修改时候不会相互锁定。">追加到64字节提高并发效率，L1缓存行是64字节。避免头尾节点不在同一个缓存行，修改时候不会相互锁定。</h2><h2 id="64位系统就是cpu通用寄存器_可以运行数据宽度为64位。">64位系统就是cpu通用寄存器 可以运行数据宽度为64位。</h2><h2 id="偏向锁和轻量级锁">偏向锁和轻量级锁</h2><p>sleep让出cup，但不会释放锁，还要保持监视状态，当sleep时间过后，会继续执行。是Thread的方法。</p>
<h2 id="wait是对象的方法，会释放锁，并且进去等待锁定池，是有当notify之后,才会进入锁定池排队。释放对象锁的只有wait()。">wait是对象的方法，会释放锁，并且进去等待锁定池，是有当notify之后,才会进入锁定池排队。释放对象锁的只有wait()。</h2><p>线程通信<br>1.共享对象实例，提供线程安全的共享对象，设置对象属性和获取对象属性来获得通信效果。<br>2.wait(),notify(),notifyAll().等待机制。 对象的wait()等操作，必须获得对象锁。退出wait时候也需要对象锁，所以notifyAll()也只能同时给一个线程调用去wait()<br>3.在wait()/notify()机制中，不要使用全局对象，字符串常量等。应该使用对应唯一的对象。<br>4.wait()会释放对象锁。wait()notify 需要获得对象锁。<br>5.丢失型号的情况，就是体现notify了，wait在后面执行，需要用变量来记录信号，wasSignalled=false,notify时候设为true,wait以后为false。</p>
<h2 id="6-重入，就是readWriteLock时候，第一次读，锁定，写等待。线程第二次再去读锁请求，就可能被等待。所以要记录线程获得读写锁。">6.重入，就是readWriteLock时候，第一次读，锁定，写等待。线程第二次再去读锁请求，就可能被等待。所以要记录线程获得读写锁。</h2><p>读写锁<br>读-读能共存，读-写不能共存，写-写不能共存。这就需要一个读/写锁来解决这个问题。</p>
<h2 id="可重入锁。避免两次进入被锁死。">可重入锁。避免两次进入被锁死。</h2><h2 id="daemon_线程，支持性线程，当程序中没有非daemon线程时，将退出。">daemon 线程，支持性线程，当程序中没有非daemon线程时，将退出。</h2><h2 id="while(on_&amp;&amp;_!Thread-currentThread()-isInterrrupted()){}_用_on_或者_interrupte()都能终止线程。">while(on &amp;&amp; !Thread.currentThread().isInterrrupted()){}  用 on 或者 interrupte()都能终止线程。</h2><h2 id="thread-join()终止，后本线程才能执行。">thread.join()终止，后本线程才能执行。</h2><h2 id="InheritableThreadLocal_可以让子线程看到父的值。">InheritableThreadLocal 可以让子线程看到父的值。</h2><h2 id="获取不到cup时间的线程会被饿死。这就是饥饿，防止饥饿需要公平性。">获取不到cup时间的线程会被饿死。这就是饥饿，防止饥饿需要公平性。</h2><p>如何在有限的资源里处理一个较大的数据:如果你处理逻辑，跟全量数据有关，例如对全部数据进行排序，这个可以采用bitmap,堆排序等之类的，网上可以搜到。</p>
<h2 id="但是如果你的处理逻辑跟全量数据无关，那就跟简单了，你可以设置一个buffer，每次读满一个buffer，处理完了，再读下一个buffer。">但是如果你的处理逻辑跟全量数据无关，那就跟简单了，你可以设置一个buffer，每次读满一个buffer，处理完了，再读下一个buffer。</h2><p>锁的核心是，队列同步器，将获取同步状态失败的线程和状态信息构成节点Node，当同步状态释放时，会把首节点线程唤醒，使其再次尝试获取同步状态。</p>
<p>独占式：同步器维护一个同步队列，获取失败的线程会加入到到队列中的tail，头节点是获取了同步状态的节点，释放同步状态后，会唤醒头节点的后续节点。tryAcquire(获取) tryRelease(释放)<br>共享式：就像读写锁一样，读的时候可以共享一起，写的时候必须是独占。</p>
<h2 id="isHeldExclusively()是否被独占。">isHeldExclusively()是否被独占。</h2><p>ReentrantLock 重入和公平性实现：<br>重入性：记录线程是否占用锁，占用则，再次进入就获得锁。自增计算获取锁的次数，在释放的时候也需要相同的次数。<br>公平性：队列中有请求锁的节点，锁的顺序必须按照请求锁的顺序。</p>
<h2 id="公平锁因为需要大量的线程切换所以，效率比非公平锁要差很多。">公平锁因为需要大量的线程切换所以，效率比非公平锁要差很多。</h2><p>HashMap 多线程下会出现死循环，因为entry在对线程下，可以出现环形数据结构，一旦形成环形数据结构，Entry的next永远不为空。<br>就会死循环。获取entry.<br>ConcurrentHashMap 锁分段技术可以提高并发效率。就是多配几把锁。Segment[(hash&gt;&gt;&gt;segmentShift)&amp;segmentMask] segmentShift=28,segmentMask =15<br>size 获取的时候，不是锁定所有的写操作，而是通过两次获得来获得size的大小是够有变化，如果没有变化就返回，有变化就采用加锁来统计。modCount 每次写入都会改变来，测试是否有变化。<br>在JDK1.8中hashMap中，如果链表数量超过8就会变成红黑树。而concurrentHashMap也有很多变化。不再使用分段锁的方式来处理并发。TreeBin 来处理TreeNode.</p>
<h2 id="我们可以发现JDK8中的实现也是锁分离的思想，只是锁住的是一个Node，而不是JDK7中的Segment，而锁住Node之前的操作是无锁的并且也是线程安全的，建立在之前提到的3个原子操作上。">我们可以发现JDK8中的实现也是锁分离的思想，只是锁住的是一个Node，而不是JDK7中的Segment，而锁住Node之前的操作是无锁的并且也是线程安全的，建立在之前提到的3个原子操作上。</h2><h2 id="工作窃取算法(work-straling)_当自己队列里的任务完成之后，窃取队列里的任务，为避免竞争从尾部拿任务，所以需要一个双向链表，也就是LinkedBlockingDeque。">工作窃取算法(work-straling) 当自己队列里的任务完成之后，窃取队列里的任务，为避免竞争从尾部拿任务，所以需要一个双向链表，也就是LinkedBlockingDeque。</h2><p>CAS :compareAndSwapObject()compareAndSwapInt()compareAndSwapLong() boolean先转换成int再处理。所以char,float,double也一样的道理。<br>如果需要原子更新多个变量就需要原子更新引用类型AtomicReference</p>
<hr>
<p>Join线程存活的情况下主线程一直wait(0) 知道所有线程都完成notifyAll之后，主线程才开始。<br>CountDownLatch.countDown()  CountDownLatch.await()   不可以重新初始化。可以await(long time.TimeUnit unit);<br>CyclicBarrier 和CountDownLatch一样也需要初始化时候知道线程数量。CyclicBarrier只有一个await方法，像栅栏一样，拦截所有的任务之后再执行action,或者主线程。<br>区别：<br>1.CountDownLatch只能用一次，但CyclicBarrier可以用Reset()重置，可以使用多次。所以可以用在更复杂的场景，比如发送错误时候，可以重置，并且重新执行现场。<br>2.CyclicBarrier可以获取堵塞的线程数量，getNumberWaiting,isBroken方法来了解线程是否被中断。<br>Semaphore:可以做限流。主要方法就是Semaphare.acquire(),Semaphare.release() 但也可以使用guava中的RateLimter<br>Exchanger用于线程间的工具类。一个线程执行exchanger 会等待第二个线程执行exchange方法，来交换线程间的数据，可以用于遗传算法场景，</p>
<hr>
<p>Fork/join  两部来实现的就是分任务和合并结果。<br>RecursiveAction(回归执行)  </p>
<h2 id="RecursiveTask">RecursiveTask </h2><p>1.当运行线程少于corePoolSize，创建新线程，这里需要获取全局锁。<br>2.当运行线程等于或多余corePoolSize的时候，任务加入BlockingQueue。<br>3.如果BlockingQueue满，则创建新的线程来处理，这里也需要全局锁(一般maximaumPoolSize和CoreSize一样会比较合理，因为全局锁或影响性能)<br>4.前面都无法执行的话，就会抛出rejectedExecutorHandler来处理。可以设置策略来处理，可以持久化任务。或者直接AbortPolicy。<br>Runtime.getRuntime().acailableProcessors()来获取cup个数。<br>guava中的 new ThreadFactoryBuilder().setNameFormat(“XX-task-%d”).build();快速创建有意义的名字。<br>Executors.newFixThreadPool 使用的是LinkedBlockQueue 因为是无解队列，队列默认是max_value所以，会出现不会拒绝，一直加入队列的情况，在高并发的情况下，这个地方可能会出现问题，安全情况下必须要有Reject的情况。</p>
<h2 id="scheduledThreadPoolExcutor_主要是有DelayQueue_来完成的，DelayQueue主要是优先队列来实现的，时间小的排前面，时间一样的sequenceMumber小的排前面，">scheduledThreadPoolExcutor 主要是有DelayQueue 来完成的，DelayQueue主要是优先队列来实现的，时间小的排前面，时间一样的sequenceMumber小的排前面，</h2><p>高并发，低耗时的情况：建议少线程，只要满足并发即可；例如并发100，线程池可能设置为10就可以. 线程少就能处理，因为耗时低，所以几个线程就够。<br>低并发，高耗时的情况：建议多线程，保证有空闲线程，接受新的任务；例如并发10，线程池可能就要设置为20，耗时高需要多线程。所以线程多少取决于耗时。<br>高并发，高耗时的情况：耗时低线程少，耗时高线程多，异步+回调。shard.</p>
<hr>
<h2 id="同步/异步_说的是程序层面，同步返回，或者异步返回。_堵塞/非堵塞_cup是否等待io操作的返回，说的是io方面的，堵塞返回，还是非堵塞返回。">同步/异步  说的是程序层面，同步返回，或者异步返回。  堵塞/非堵塞 cup是否等待io操作的返回，说的是io方面的，堵塞返回，还是非堵塞返回。</h2><p>生产消费模式能解决大部分并发问题。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/05/12/并发编程/" data-id="cixo3b4su0025zes69zhh9ly6" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/并发编程/">并发编程</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-java_volatile" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/12/java_volatile/">Java volatile 解析</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/05/12/java_volatile/">
      <time datetime="2016-05-12T04:13:36.000Z" itemprop="datePublished">2016-05-12</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p><img src="/thumbnails/volatile.jpg" alt=""></p>
<h2 id="一-_volatite_简述">一. volatite 简述</h2><p>Java 语言提供了一种稍弱的同步机制,即 volatile 变量.用来确保将变量的更新操作通知到其他线程,保证了新值能立即同步到主内存,以及每次使用前立即从主内存刷新. 当把变量声明为volatile类型后,编译器与运行时都会注意到这个变量是共享的.</p>
<hr>
<p>不保证线程安全因为不是原子操作。对于volatile修饰的变量，jvm虚拟机只是保证从主内存加载到线程工作内存的值是最新的.</p>
<hr>
<p>volatile关键字的两层语义<br>     一旦一个共享变量（类的成员变量、类的静态成员变量）被volatile修饰之后，那么就具备了两层语义：</p>
<p>　　1）保证了不同线程对这个变量进行操作时的可见性，即一个线程修改了某个变量的值，这新值对其他线程来说是立即可见的。</p>
<h2 id="2）禁止进行指令重排序。">　　2）禁止进行指令重排序。</h2><p>volatile保证原子性吗？<br>     从上面知道volatile关键字保证了操作的可见性，但是volatile能保证对变量的操作是原子性吗？<br>     这里面就有一个误区了，volatile关键字能保证可见性没有错，可见性只能保证每次读取的是最新的值，但是volatile没办法保证对变量的操作的原子性。<br>     所以在多线程非原子性操作共享变量的情况下，就会出现问题。<br>volatile能保证有序性吗？<br>　　在前面提到volatile关键字能禁止指令重排序，所以volatile能在一定程度上保证有序性。<br>　　volatile关键字禁止指令重排序有两层意思：<br>　　1）当程序执行到volatile变量的读操作或者写操作时，在其前面的操作的更改肯定全部已经进行，且结果已经对后面的操作可见；在其后面的操作肯定还没有进行；</p>
<p>　　2）在进行指令优化时，不能将在对volatile变量访问的语句放在其后面执行，也不能把volatile变量后面的语句放到其前面执行。</p>
<hr>
<p>volatile的原理和实现机制</p>
<p>　　前面讲述了源于volatile关键字的一些使用，下面我们来探讨一下volatile到底如何保证可见性和禁止指令重排序的。</p>
<p>　　“观察加入volatile关键字和没有加入volatile关键字时所生成的汇编代码发现，加入volatile关键字时，会多出一个lock前缀指令”</p>
<p>　　lock前缀指令实际上相当于一个内存屏障（也成内存栅栏），内存屏障会提供3个功能：</p>
<p>　　1）它确保指令重排序时不会把其后面的指令排到内存屏障之前的位置，也不会把前面的指令排到内存屏障的后面；即在执行到内存屏障这句指令时，在它前面的操作已经全部完成；</p>
<p>　　2）它会强制将对缓存的修改操作立即写入主存；</p>
<h2 id="3）如果是写操作，它会导致其他CPU中对应的缓存行无效。">　　3）如果是写操作，它会导致其他CPU中对应的缓存行无效。</h2><p>使用volatile关键字的场景</p>
<p>　　synchronized关键字是防止多个线程同时执行一段代码，那么就会很影响程序执行效率，而volatile关键字在某些情况下性能要优于synchronized，但是要注意volatile关键字是无法替代synchronized关键字的，因为volatile关键字无法保证操作的原子性。通常来说，使用volatile必须具备以下2个条件：</p>
<p>　　1）对变量的写操作不依赖于当前值</p>
<p>　　2）该变量没有包含在具有其他变量的不变式中</p>
<p>　　实际上，这些条件表明，可以被写入 volatile 变量的这些有效值独立于任何程序的状态，包括变量的当前状态。</p>
<h2 id="事实上，我的理解就是上面的2个条件需要保证操作是原子性操作，才能保证使用volatile关键字的程序在并发时能够正确执行。">　　事实上，我的理解就是上面的2个条件需要保证操作是原子性操作，才能保证使用volatile关键字的程序在并发时能够正确执行。</h2><p>使用场景<br>1.状态标记量<br><figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">volatile</span> <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">while</span>(!flag)&#123;</span><br><span class="line">    doSomething();</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">setFlag</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    flag = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">volatile</span> <span class="keyword">boolean</span> inited = <span class="keyword">false</span>;</span><br><span class="line"><span class="comment">//线程1:</span></span><br><span class="line">context = loadContext();  </span><br><span class="line">inited = <span class="keyword">true</span>;            </span><br><span class="line"> </span><br><span class="line"><span class="comment">//线程2:</span></span><br><span class="line"><span class="keyword">while</span>(!inited )&#123;</span><br><span class="line">sleep()</span><br><span class="line">&#125;</span><br><span class="line">doSomethingwithconfig(context);</span><br></pre></td></tr></table></figure></p>
<p>2.双重验证(Double check)<br><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class Singleton&#123;</span><br><span class="line">   <span class="keyword"> private</span> volatile<span class="keyword"> static</span> Singleton<span class="instruction"> instance </span>= null;</span><br><span class="line">     </span><br><span class="line">   <span class="keyword"> private</span><span class="function"> Singleton(</span><span class="function">)</span> &#123;</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">   <span class="keyword"> public</span><span class="keyword"> static</span> Singleton<span class="function"> getInstance(</span><span class="function">)</span> &#123;</span><br><span class="line">       <span class="function"> if(</span>instance==null<span class="function">)</span> &#123;</span><br><span class="line">            synchronized<span class="function"> (</span>Singleton.class<span class="function">)</span> &#123;</span><br><span class="line">               <span class="function"> if(</span>instance==null<span class="function">)</span></span><br><span class="line">                   <span class="instruction"> instance </span>=<span class="instruction"> new </span>Singleton(<span class="function">)</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">       <span class="instruction"> return </span>instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/05/12/java_volatile/" data-id="cixo3b4wa009czes6o5bycwom" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/volatite/">volatite</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-消息中间件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/12/消息中间件/">消息中间件</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/05/12/消息中间件/">
      <time datetime="2016-05-12T04:13:36.000Z" itemprop="datePublished">2016-05-12</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/中间件/">中间件</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <pre><code>基于服务框架的消息中间件。调用过程 Producr-&gt;<span class="keyword">Broker-&gt;Consumer </span>生产者发送给<span class="keyword">Broker,Broker </span>也是暴露出来的服务，让生产者调用。再由<span class="keyword">Broker来负责广播出去，生产者只要事务保证broker接收到消息，broker </span>再保证能广播到所有的订阅者。也就是消费者。这就是一个消息发送流程。
</code></pre><hr>
<pre><code>中间件服务中的 Receiver 接收到消息之后，过滤操作之后，再发BroadCast给所有的<span class="keyword">group</span>,Consumer.
</code></pre><hr>
<p>中间件优化<br>1.发送消息给消费者时候，投递消息的线程只保证网络接收就返回，等待做完业务处理之后再ack.更改消息状态。<br>2.当同一台机器或者，多订阅的时候，可以合并同一个订阅管理，actor一样的订阅管理器。<br>3.消息状态可以保存在broker 上的redis的集群中。通过检查集群消息状态来判断是否消息投递成功。<br>4.消息去重在broker上的数据集去重来保证。<br>5.消息到消费端的去重主要是幂等，和消息客户端去重。或者他们来做幂等。<br>6.消息的优先级，就是分多queue,有优先级别比较高的queue,分配的资源多一点。hash 来决定放在什么queue里。<br>7。消息的顺序性需要用pull来实现。并且保证单队列。  </p>
<hr>
<p>设计优势<br>1.对比rockermq，两次网络提交的情况下少了一次网络提交。但多了一次消息落地，能有效的实现重发，和重试。业务侵入性增加，但使用简单。<br>2.在broker方便，因为消息落体也在一个关系行数据库中，所以不稳定性全部交个这个数据库了，broker是无状态的，不想本地持久化一样，有状态必须有主备来完成。但这样效率会低一些，多一次网络交互。<br>3.消息pull能提高消息顺序性的保障。但增加了broker机器的io,如果不是mmap的情况下。而且需要维护一套，各个节点pull的offset.连续情况下是不需要维护offset的，push 比较及时。当需要broker 来维护消费状态，流量控制也需要在broker来做，传输失败重试也是broker来做。<br>4.优化方面只是 本地持久化来代替关系型数据库，但这个开发成本很高。<br>5.事务一致性，和高可用可以分为两个概念。一个是成功一起成功，失败一起失败，一个是第一个成功，第二个也必须成功。这是两个概念。<br>6.延时消息存储在mysql，中要比存储在本地文件中要，方便得多，只要定时扫描数据库就可以了。<br>7.如果不仅做数据库操作,还调用了 RPC。这样的动作是不能放在一个数据库事务里的，所以对于这种场景就不能满足了。现在遇到这种情况只有把RPC 这种操作拆出去了。所以这种模型的优点就是使用方便，但是有些限制。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/05/12/消息中间件/" data-id="cixo3b4s50010zes6qdjv25s8" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/消息中间件/">消息中间件</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-内存模型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/12/内存模型/">内存模型</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/05/12/内存模型/">
      <time datetime="2016-05-12T04:13:36.000Z" itemprop="datePublished">2016-05-12</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>1.cpu计算时，因为cpu计算速度远大于内存的读写速度，简单就说cpu算好了，但还需要等待内存读写，这很不利于高速计算。所以在这里加入了高速缓存，来处理cpu读写结果。<br>举个简单的例子，比如下面的这段代码：<br><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">i</span> = <span class="built_in">i</span> + <span class="number">1</span>;</span><br></pre></td></tr></table></figure></p>
<p> 当线程执行这个语句时，会先从主存当中读取i的值，然后复制一份到高速缓存当中，然后CPU执行指令对i进行加1操作，然后将数据写入高速缓存，最后将高速缓存中i最新的值刷新到主存当中。本身为解决CPU的使用率。但这会出现缓存一致性问题。也就是多线程都在进行同一个写操作的时候，没有办法做到最终一致性。为了解决缓存不一致性问题，通常来说有以下2种解决方法：<br>　　1.通过在总线加LOCK#锁的方式。也就是对象加锁，防止多cpu调用，可想这样的方式效率多低。为解决效率所以才有了2。</p>
<p>　　2.通过缓存一致性协议<br>    代表就是intel 的MESI协议。<br>     MESI协议保证了每个缓存中使用的共享变量的副本是一致的。它核心的思想是：当CPU写数据时，如果发现操作的变量是共享变量，即在其他CPU中也存在该变量的副本，会发出信号通知其他CPU将该变量的缓存行置为无效状态，因此当其他CPU需要读取这个变量时，发现自己缓存中缓存该变量的缓存行是无效的，那么它就会从内存重新读取。共享变量，不可用，每次都要去取。</p>
<hr>
<p>Java内存模型<br>1.在Java虚拟机规范中试图定义一种Java内存模型（Java Memory Model，JMM）来屏蔽各个硬件平台和操作系统的内存访问差异，以实现让Java程序在各种平台下都能达到一致的内存访问效果。<br>2.Java内存模型规定所有的变量都是存在主存当中（类似于前面说的物理内存），每个线程都有自己的工作内存（类似于前面的高速缓存）。线程对变量的所有操作都必须在工作内存中进行，而不能直接对主存进行操作。并且每个线程不能访问其他线程的工作内存。<br>JAVA内存原子性：只有对基本数据类型的变量的读取和赋值操作是原子性操作。不是简单类型都不是。<br>如果要实现更大范围操作的原子性，可以通过synchronized和Lock来实现。由于synchronized和Lock能够保证任一时刻只有一个线程执行该代码块，那么自然就不存在原子性问题了，从而保证了原子性<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">10</span>;         <span class="comment">//原子操作，直接把10写入主存</span></span><br><span class="line">y = x;         <span class="comment">//读取主存中的x,赋值写入到y的工作内存，两个原子操作。</span></span><br><span class="line">x++;           <span class="comment">//读取，加1操作，赋值</span></span><br><span class="line">x = x + <span class="number">1</span>;     <span class="comment">//读取，加1操作，赋值</span></span><br></pre></td></tr></table></figure></p>
<p>可见性：对于可见性，Java提供了volatile关键字来保证可见性.当一个共享变量被volatile修饰时，它会保证修改的值会立即被更新到主存，当有其他线程需要读取时，它会去内存中读取新值。通过synchronized和Lock也能够保证可见性。只是效率低。</p>
<p>有序性:<br>   程序次序规则：一个线程内，按照代码顺序，书写在前面的操作先行发生于书写在后面的操作<br>   锁定规则：一个unLock操作先行发生于后面对同一个锁额lock操作<br>   volatile变量规则：对一个变量的写操作先行发生于后面对这个变量的读操作<br>   传递规则：如果操作A先行发生于操作B，而操作B又先行发生于操作C，则可以得出操作A先行发生于操作C</p>
<p>[TOC]</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/05/12/内存模型/" data-id="cixo3b4tk003gzes6lxgt5o81" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/内存模型/">内存模型</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-store" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/11/store/">store</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/05/11/store/">
      <time datetime="2016-05-11T01:13:36.000Z" itemprop="datePublished">2016-05-11</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/java/">java</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>1.乐观锁：只保证version等于oldversion的情况下才更新。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`order_detail_37`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增主键'</span>,</span><br><span class="line">  <span class="string">`order_id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单id'</span>,</span><br><span class="line">  <span class="string">`version`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'更新时的版本号'</span>,</span><br><span class="line">  <span class="string">`section`</span> <span class="built_in">varchar</span>(<span class="number">16</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单详情type,区分不同模块数据'</span>,</span><br><span class="line">  <span class="string">`data`</span> <span class="built_in">text</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单详情数据'</span>,</span><br><span class="line">  <span class="string">`create_date`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'创建时间'</span>,</span><br><span class="line">  <span class="string">`update_time`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'更新时间'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uniq_order_id_type`</span> (<span class="string">`order_id`</span>,<span class="string">`section`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COMMENT</span>=<span class="string">'订单详情信息表'</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`op_log_07`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增主键'</span>,</span><br><span class="line">  <span class="string">`order_id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单id'</span>,</span><br><span class="line">  <span class="string">`version`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'更新时的版本号'</span>,</span><br><span class="line">  <span class="string">`last_version`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span> <span class="string">'上一次的版本号'</span>,</span><br><span class="line">  <span class="string">`op_log`</span> <span class="built_in">text</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'op log json data'</span>,</span><br><span class="line">  <span class="string">`create_date`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'1970-00-00 00:00:00'</span> <span class="keyword">COMMENT</span> <span class="string">'订单创建时间'</span>,</span><br><span class="line">  <span class="string">`update_time`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'此次操作的时间'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uniq_order_id_version`</span> (<span class="string">`order_id`</span>,<span class="string">`version`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COMMENT</span>=<span class="string">'操作日志表'</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`order_main_04`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增主键'</span>,</span><br><span class="line">  <span class="string">`order_id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单id'</span>,</span><br><span class="line">  <span class="string">`version`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'1'</span> <span class="keyword">COMMENT</span> <span class="string">'变更版本号'</span>,</span><br><span class="line">  <span class="string">`create_date`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'创建时间'</span>,</span><br><span class="line">  <span class="string">`update_time`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'更新时间'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uniq_order_id`</span> (<span class="string">`order_id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_create_date`</span> (<span class="string">`create_date`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_update_time`</span> (<span class="string">`update_time`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'订单更新表'</span></span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`order_route_config`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增主键'</span>,</span><br><span class="line">  <span class="string">`order_id_step`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单id偏移量'</span>,</span><br><span class="line">  <span class="string">`database_names`</span> <span class="built_in">varchar</span>(<span class="number">256</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'映射到的数据库名，支持多个，逗号分隔'</span>,</span><br><span class="line">  <span class="string">`tab_suffix`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'映射到的表名'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uniq_order_id_step`</span> (<span class="string">`order_id_step`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">2</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'订单数据分库分表映射'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`order_shard_mapper`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增主键'</span>,</span><br><span class="line">  <span class="string">`day`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'0000-00-00 00:00:00'</span> <span class="keyword">COMMENT</span> <span class="string">'映射 的日期'</span>,</span><br><span class="line">  <span class="string">`database_path`</span> <span class="built_in">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'映射到的数据库名'</span>,</span><br><span class="line">  <span class="string">`table_path`</span> <span class="built_in">varchar</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'映射到的表明'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uniq_day`</span> (<span class="string">`day`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_database_path_table_path`</span> (<span class="string">`database_path`</span>,<span class="string">`table_path`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'订单数据分库分表映射'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`remark_01`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">unsigned</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增主键'</span>,</span><br><span class="line">  <span class="string">`order_id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单id'</span>,</span><br><span class="line">  <span class="string">`content`</span> <span class="built_in">text</span> <span class="keyword">COMMENT</span> <span class="string">'order_remark json data'</span>,</span><br><span class="line">  <span class="string">`create_time`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'备注创建时间'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_order_id`</span> (<span class="string">`order_id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COMMENT</span>=<span class="string">'订单备注表'</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`treecode_update`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'id'</span>,</span><br><span class="line">  <span class="string">`hotel_id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'酒店id'</span>,</span><br><span class="line">  <span class="string">`create_date`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'创建时间'</span>,</span><br><span class="line">  <span class="string">`update_time`</span> <span class="keyword">timestamp</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CURRENT_TIMESTAMP</span> <span class="keyword">COMMENT</span> <span class="string">'更新时间'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">KEY</span> <span class="string">`idx_hotel_id`</span> (<span class="string">`hotel_id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'treecode更新记录'</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`order_index_manage`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`idx_name`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'对应的索引表表名'</span>,</span><br><span class="line">  <span class="string">`column_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'column名'</span>,</span><br><span class="line">  <span class="string">`column_type`</span> <span class="built_in">varchar</span>(<span class="number">64</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">'strings'</span> <span class="keyword">COMMENT</span> <span class="string">'数据类型'</span>,</span><br><span class="line">  <span class="string">`path`</span> <span class="built_in">varchar</span>(<span class="number">512</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'json.field.path'</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`uniq_name_column`</span> (<span class="string">`idx_name`</span>,<span class="string">`column_name`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">84</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 <span class="keyword">COMMENT</span>=<span class="string">'订单索引表的索引'</span></span></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/05/11/store/" data-id="cixo3b4uc004vzes62eb9nd70" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/store/">store</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-RocketMQ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/20/RocketMQ/">RocketMq</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/04/20/RocketMQ/">
      <time datetime="2016-04-20T04:13:36.000Z" itemprop="datePublished">2016-04-20</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/分布式消息队列/">分布式消息队列</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>1.RocketMQ 满足顺序性，必须Producer单线程顺序发送，且发送到同一个队列。如果broke断了，选择重新hash一个队列的情况下消息顺序会产生变化，但如果必须保证顺序，那只有等待broken恢复，这也造成可用性大大降低。这是为保证抢顺序性的弊端，目前已知的应用只有数据库 binlog 同步强依赖严格顺序消息，其他应用绝大部分都可以容忍短暂乱序。<br>2.RocketMQ 使用长轮询 Pull 方式，可保证消息非常实时，消息实时性不低于 Push。<br>3.RocketMQ 参考了 Kafka 的持久化方式，充分利用 Linux 文件系统内存 cache 来提高性能。<br>4.RocketMQ 为了追求高性能，并不保证消息去从，要求在业务上进行去重，也就是说消费消息要做到幂等性<br>5.RocketMQ 没有内存 Buffer 概念，RocketMQ 的队列都是持久化磁盘，数据定期清除。<br>6.RocketMQ 支持按照时间回溯消费，时间维度精确到毫秒，可以向前回溯，也可以向后回溯。<br>7.RocketMQ 支持定时消息，但是不支持任意时间精度，支持特定的 level，例如定时 5s，10s，1m 等。<br>8.RocketMQ 没有特意支持消息优先级，因为按优先级来排序，开销会非常大，因此 但是可以通过变通的方式实现类似功能，即单独配置一个优先级高的队列，和一个普通优先级<br>的队列，将不同优先级发送到不同队列即可。<br>9.RocketMQ 在Broker端消息过滤，优点是减少了对于 Consumer 无用消息的网络传输。缺点是增加了Broker的负担,实现相对复杂。Consumer端消息过滤，由业务端实现，但网络消耗大<br>10.RocketMQ 采用第一阶段发送 Prepared 消息时，拿到了消息的 Offset，第二阶段通过 Offset 去访问消息，并修改状态，Offset 就是数据的地址。通过 Offset 方式，存在一个显著缺陷，即通过 Offset更改数据，会令系统的脏页过多，需要特别关注。consumerQueue中放入commitLogOffset，消费端才能取到数据。<br>11.大事务=小事务+异步 异步事务两次提交。broker会有消息确认机制来确认，事务是否正常，来做是否发送消息的操作。</p>
<hr>
<p>rocketmq<br>1.nameServer 是无状态的节点，可以集群，但节点之间是不通信的。所以这个不适合做大型的集群。<br>2.broker的master和slave部署是brokenName一样，brokenId不一样。broke和nameServer之间是长连接，并定时topic信息到nameServe.<br>3.producer和nameserv其中一个节点随机建立长链接，定时从nameServer取topic信息，并向提供topic服务的master建立长连接，且定时心跳，producer无状态，可以集群部署。<br>4.consumer和producer一样，也是随机一个nameServer建立链接，定时从nameServer取topic信息，但consumer长连接master和slave,心跳，并且消费路由是broker来决定。<br>5.producer Group 同一类生产者主要作用 发送分布式事务消息时，如果Producer中途意外宕机，Broker会主动回调Producer Group内的任意一台机器来确认事务状态。<br>6.Consumer 消费消息过程，使用了零拷贝，零拷贝包含 使用 mmap + write 方式 使用 sendfile 方式<br>7.RocketMQ 选择 Linux Ext4 文件系统<br>8.消费队列只存储commitlog的offset这样做的优点，轻量化队列，对磁盘串行访问，避免竞争。缺点。顺序写，随机读。读数据线读comsumeQueue再读commitLog.要保证commitlog和comsumerQuere的完全一增加复杂度和开销。<br>9.让随机读多使用pagecache，所谓内存越大越好，调整io调度算法为noop方式，会让随机读性能提高5倍。<br>10.comsumerQueue是顺序读并且有pagecache所以基本没有读障碍，commitlog性能会降低，但能保证稳定性。<br>11.RocketMQ 的所有消息都是持久化的，先写入系统 PAGECACHE，然后刷盘，可以保证内存与磁盘都有一份数据，访问时，直接从内存读取。<br>12.异步刷盘 会不会产生pagecache溢出呢，网络速度小于磁盘速度，不会出现。就算大于，也会有lru算法来淘汰内存。和同步刷盘 同步刷盘与异步刷盘的唯一区别是异步刷盘写完 PAGECACHE 直接返回，而同步刷盘需要等待刷盘完成才返回，同步刷盘流程如下：<br>(1). 写入 PAGECACHE 后，线程等待，通知刷盘线程刷盘。<br>(2). 刷盘线程刷盘后，唤醒前端等待线程，可能是一批线程。<br>(3). 前端等待线程向用户返回成功。<br>13.消息的messageid,broker地址和offset,MsgId 总共 16 字节，<br>14.消息过来在consumerqueue中的msgtaghashcode。如果consumer没匹配上这个hashcode,就跳过不消费。即使存在Hash冲突，也可以在 Consumer 端进行修正，保证万无一失。<br>15.顺序消息的缺陷 发送顺序消息无法利用集群 FailOver 特性 消费顺序消息的并行度依赖于队列数量队列热点问题，个别队列由于哈希不均导致消息过多，消费速度跟不上，产生消息堆积问题 遇到消息失败的消息，无法跳过，当前队列消费暂停<br>16.roundbin轮询方式调度。来发送消息。consumer 的消费方式有很多种。<br>17.异步复制的实现思路非常简单，Slave 启动一个线程，不断从 Master 拉取 Commit Log 中的数据，然后在异步build 出 Consume Queue 数据结构。整个实现过程基本同 Mysql 主从同步类似。<br>18.slave 是批量拉master所以写性能要比master消耗小，当consumer slave时候，要比master能扛，当发现消息堆积的时候就可以让slave来提供consumer</p>
<ol>
<li>Broker 所在的机器会启动多个 FilterServer 过滤进程</li>
<li>Consumer 启动后，会向 FilterServer 上传一个过滤的 Java 类</li>
<li>Consumer 从 FilterServer 拉消息，FilterServer 将请求转发给 Broker，FilterServer 从 Broker 收到消息后，按照<br>Consumer 上传的 Java 过滤程序做过滤，过滤完成后返回给 Consumer。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/04/20/RocketMQ/" data-id="cixo3b4ya00cuzes6lp40296w" class="article-share-link">分享到</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/RocketMQ/">RocketMQ</a></li></ul>

    </footer>
  </div>
  
</article>



    
      <article id="post-分布式系统一致性" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/20/分布式系统一致性/">分布式系统一致性</a>
    </h1>
  

        <div class="article-meta">
          
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2016/04/20/分布式系统一致性/">
      <time datetime="2016-04-20T04:13:36.000Z" itemprop="datePublished">2016-04-20</time>
    </a>
  </div>


          
  <div class="article-category">
  	<i class="fa fa-folder"></i>
    <a class="article-category-link" href="/categories/分布式/">分布式</a>
  </div>

        </div>
      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
                
        <p>CAP(consistency Availability Partition tolerance)<br>一致性：数据，状态一致。很容易理解<br>可用性：高性能，在处理状态修改是，性能很高。不会出现逆转，不可用。<br>分区隔离性：但一部分出现问题断线了，也可以继续使用。</p>
<p>强一致：就是用户上一次写什么，下一次就保证能读到什么。也就是要么一起成功要么一起失败，统一结果，同一时刻的原子性，根据 CAP 理论，这种实现需要牺牲可用性。就是慢慢慢。强一致就不可能高可用。因为强一致，的复杂校验确认就不可能高可用。<br>弱一致：系统无法保证写入成功以后，不承若立刻读到最新写入的数据。也不保证多久能读到。<br>最终一致性：保证最终是一致的，但这个时间取决于网络，系统负债，副本数等。DNS就是最终一致性系统。es 也算是最终一致性系统。工程实际用这个最多，为保证可用性。</p>
<hr>
<p>ACID(Atomicity,concisitency,Isolation,Durability)<br>传统关系型数据库的事务模型必须遵守 ACID 原则。 分区隔离性，比较难实现。</p>
<hr>
<p>BASE(Basically Available,Soft state,Eventually consistent)</p>
<hr>
<p>分布式一致性解决方案。<br>1.避免分布式事务。从业务上吧多个服务整合成本地服务。<br>2.把多个分布式事务，分解成多个小事务，本地事务，并异步消息队列来处理，达到最终一致性。为保证可用性，还是最终一致性靠谱。<br>3.DTS 方案 2PC 的基础上改进而来，业务活动管理器控制业务活动的一致性,tcc(try confirm cancel) 操作来控制业务活动。和2pc相比，减少了Prepare.优点就是有专门的模块来处理，确认和回滚。不需要调用业务来处理。这是和2pc的区别。<br>4.分布式服务对衍生的配套系统要求比较多，特别是我们基于消息、日志的最终一致性方案，需要考虑消息的积压、消费情况、监控、报警等。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.fovoy.com/2016/04/20/分布式系统一致性/" data-id="cixo3b4tc0032zes6vvoadoks" class="article-share-link">分享到</a>
      
      
    </footer>
  </div>
  
</article>



    
      <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/3/">下一页 &raquo;</a>
      </nav>
    </section>
      
        <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul id="recent-post" class="">
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2017/01/01/2016的我/" class="thumbnail">
  
    <span style="background-image:url(/thumbnails/td.jpg
)" alt="2017" class="thumbnail-image"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/计划/">计划</a></p>
              <p class="item-title"><a href="/2017/01/01/2016的我/" class="title">2017</a></p>
              <p class="item-date"><time datetime="2017-01-01T02:13:22.000Z" itemprop="datePublished">2017-01-01</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/11/24/分布式id生成器/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/分布式/">分布式</a></p>
              <p class="item-title"><a href="/2016/11/24/分布式id生成器/" class="title">分布式ID生成器</a></p>
              <p class="item-date"><time datetime="2016-11-24T02:49:03.000Z" itemprop="datePublished">2016-11-24</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/11/12/异步化方案/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/java/">java</a></p>
              <p class="item-title"><a href="/2016/11/12/异步化方案/" class="title">异步化方案</a></p>
              <p class="item-date"><time datetime="2016-11-12T05:22:01.000Z" itemprop="datePublished">2016-11-12</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/11/07/metaspace/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/JVM/">JVM</a></p>
              <p class="item-title"><a href="/2016/11/07/metaspace/" class="title">metaspace</a></p>
              <p class="item-date"><time datetime="2016-11-07T01:13:36.000Z" itemprop="datePublished">2016-11-07</time></p>
            </div>
          </li>
        
          <li>
            
            <div class="item-thumbnail">
              <a href="/2016/11/05/红黑树/" class="thumbnail">
  
    <span class="thumbnail-image thumbnail-none"></span>
  
</a>
            </div>
            
            <div class="item-inner">
              <p class="item-category"><a class="article-category-link" href="/categories/数据结构/">数据结构</a></p>
              <p class="item-title"><a href="/2016/11/05/红黑树/" class="title">红黑树</a></p>
              <p class="item-date"><time datetime="2016-11-05T01:13:36.000Z" itemprop="datePublished">2016-11-05</time></p>
            </div>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/">Elasticsearch</a><span class="category-list-count">13</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/config/">config</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/performance/">performance</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Elasticsearch/学习/">学习</a><span class="category-list-count">6</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/">Framework</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Framework/spring/">spring</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/JAVA/">JAVA</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JVM/">JVM</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Math/Matrix/">Matrix</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/分布/">分布</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/design-pattern/">design pattern</a><span class="category-list-count">12</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/elasticsearch/">elasticsearch</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/elasticsearch/运维/">运维</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/fovoy/">fovoy</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/gradle/">gradle</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/http/">http</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/gc/">gc</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/jvm/">jvm</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/学习/">学习</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/kibana/">kibana</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/lucene/">lucene</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/">mysql</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/mysql/config/">config</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/netty/">netty</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/recommendation/">recommendation</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/recommendation/协同过滤/">协同过滤</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/scala/">scala</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/scala/基础/">基础</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/site/">site</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/">tools</a><span class="category-list-count">14</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/tools/git/">git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/hexo/">hexo</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tools/nginx/">nginx</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/中间件/">中间件</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/中间件/kafka/">kafka</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/中间件/tomcat/">tomcat</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/主题模型/">主题模型</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/主题模型/主题抽取/">主题抽取</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/兴趣/">兴趣</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式/">分布式</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式消息队列/">分布式消息队列</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/分布式系统/">分布式系统</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/">前端开发</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/angularjs/">angularjs</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/html5/">html5</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/node-js/">node.js</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/nodejs/">nodejs</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/前端开发/学习/">学习</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/基础架构/">基础架构</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/大数据/">大数据</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/并发编程/">并发编程</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/总结/">总结</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构/">数据结构</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/系统/">系统</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络/">网络</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/英语学习/">英语学习</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计划/">计划</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/读书/">读书</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ConcurrentModificationException/">ConcurrentModificationException</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Elasticsearch/">Elasticsearch</a><span class="tag-list-count">13</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Future/">Future</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JVM/">JVM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LRU/">LRU</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac/">Mac</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Math/">Math</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Quasar/">Quasar</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RocketMQ/">RocketMQ</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ThreadLocal/">ThreadLocal</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/angularjs/">angularjs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/base/">base</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design-pattern/">design pattern</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/">elasticsearch</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fovoy/">fovoy</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gc/">gc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html5/">html5</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/idea/">idea</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/id生成器/">id生成器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ip/">ip</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/">jvm</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kibana/">kibana</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lock/">lock</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lucene/">lucene</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netty/">netty</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/node-js/">node.js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/order/">order</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/play/">play</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/recommendation/">recommendation</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reflect/">reflect</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rest/">rest</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/">scala</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/secureCRT/">secureCRT</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/site/">site</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/store/">store</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/">tomcat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tree/">tree</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/volatite/">volatite</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/专注/">专注</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/主题模型/">主题模型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/人工智能/">人工智能</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/内存模型/">内存模型</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/分布式系统介绍/">分布式系统介绍</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/前端开发/">前端开发</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/同步容器/">同步容器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/基础/">基础</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/堵塞队列/">堵塞队列</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小说/">小说</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/并发编程/">并发编程</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/应用中心/">应用中心</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/异常/">异常</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构/">数据结构</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/消息中间件/">消息中间件</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程/">线程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/线程池/">线程池</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编码/">编码</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/网络/">网络</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/英语学习/">英语学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计划/">计划</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/进程和线程/">进程和线程</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/配置中心/">配置中心</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/问题/">问题</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/ConcurrentModificationException/" style="font-size: 10px;">ConcurrentModificationException</a> <a href="/tags/Elasticsearch/" style="font-size: 20px;">Elasticsearch</a> <a href="/tags/Future/" style="font-size: 10px;">Future</a> <a href="/tags/JVM/" style="font-size: 10px;">JVM</a> <a href="/tags/LRU/" style="font-size: 10px;">LRU</a> <a href="/tags/Mac/" style="font-size: 10px;">Mac</a> <a href="/tags/Math/" style="font-size: 12px;">Math</a> <a href="/tags/Quasar/" style="font-size: 10px;">Quasar</a> <a href="/tags/RocketMQ/" style="font-size: 10px;">RocketMQ</a> <a href="/tags/ThreadLocal/" style="font-size: 10px;">ThreadLocal</a> <a href="/tags/angularjs/" style="font-size: 10px;">angularjs</a> <a href="/tags/base/" style="font-size: 10px;">base</a> <a href="/tags/design-pattern/" style="font-size: 18px;">design pattern</a> <a href="/tags/elasticsearch/" style="font-size: 12px;">elasticsearch</a> <a href="/tags/fovoy/" style="font-size: 12px;">fovoy</a> <a href="/tags/gc/" style="font-size: 10px;">gc</a> <a href="/tags/git/" style="font-size: 10px;">git</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/idea/" style="font-size: 10px;">idea</a> <a href="/tags/id生成器/" style="font-size: 10px;">id生成器</a> <a href="/tags/ip/" style="font-size: 10px;">ip</a> <a href="/tags/java/" style="font-size: 14px;">java</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/kibana/" style="font-size: 10px;">kibana</a> <a href="/tags/lock/" style="font-size: 10px;">lock</a> <a href="/tags/lucene/" style="font-size: 10px;">lucene</a> <a href="/tags/mysql/" style="font-size: 14px;">mysql</a> <a href="/tags/netty/" style="font-size: 10px;">netty</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/node-js/" style="font-size: 10px;">node.js</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/order/" style="font-size: 10px;">order</a> <a href="/tags/play/" style="font-size: 10px;">play</a> <a href="/tags/recommendation/" style="font-size: 10px;">recommendation</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/reflect/" style="font-size: 10px;">reflect</a> <a href="/tags/rest/" style="font-size: 10px;">rest</a> <a href="/tags/scala/" style="font-size: 10px;">scala</a> <a href="/tags/secureCRT/" style="font-size: 10px;">secureCRT</a> <a href="/tags/site/" style="font-size: 10px;">site</a> <a href="/tags/spring/" style="font-size: 14px;">spring</a> <a href="/tags/store/" style="font-size: 10px;">store</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/tools/" style="font-size: 16px;">tools</a> <a href="/tags/tree/" style="font-size: 10px;">tree</a> <a href="/tags/volatite/" style="font-size: 10px;">volatite</a> <a href="/tags/专注/" style="font-size: 10px;">专注</a> <a href="/tags/主题模型/" style="font-size: 10px;">主题模型</a> <a href="/tags/人工智能/" style="font-size: 10px;">人工智能</a> <a href="/tags/内存模型/" style="font-size: 10px;">内存模型</a> <a href="/tags/分布式系统介绍/" style="font-size: 10px;">分布式系统介绍</a> <a href="/tags/前端开发/" style="font-size: 10px;">前端开发</a> <a href="/tags/同步容器/" style="font-size: 10px;">同步容器</a> <a href="/tags/基础/" style="font-size: 12px;">基础</a> <a href="/tags/堵塞队列/" style="font-size: 10px;">堵塞队列</a> <a href="/tags/小说/" style="font-size: 10px;">小说</a> <a href="/tags/并发编程/" style="font-size: 12px;">并发编程</a> <a href="/tags/应用中心/" style="font-size: 10px;">应用中心</a> <a href="/tags/异常/" style="font-size: 10px;">异常</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a> <a href="/tags/消息中间件/" style="font-size: 10px;">消息中间件</a> <a href="/tags/线程/" style="font-size: 10px;">线程</a> <a href="/tags/线程池/" style="font-size: 10px;">线程池</a> <a href="/tags/编码/" style="font-size: 10px;">编码</a> <a href="/tags/网络/" style="font-size: 10px;">网络</a> <a href="/tags/英语学习/" style="font-size: 10px;">英语学习</a> <a href="/tags/计划/" style="font-size: 10px;">计划</a> <a href="/tags/进程和线程/" style="font-size: 10px;">进程和线程</a> <a href="/tags/配置中心/" style="font-size: 10px;">配置中心</a> <a href="/tags/问题/" style="font-size: 10px;">问题</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">五月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">12</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">14</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">八月 2015</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/07/">七月 2015</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/05/">五月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">四月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/03/">三月 2015</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">二月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">一月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/12/">十二月 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/11/">十一月 2014</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">十月 2014</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/07/">七月 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/06/">六月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/05/">五月 2014</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/04/">四月 2014</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">三月 2014</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">一月 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">十月 2013</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
  <div id="toTop" class="fa fa-chevron-up"></div>
</aside>
      
    </div>
    <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2000 - 2017 z-star<br>
      github <a href="http://github.com/z-star">z-star</a>
    </div>
  </div>
</footer>
    



 <script src="//ajax.useso.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>




  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/script.js" type="text/javascript"></script>

  </div>
</body>
</html>